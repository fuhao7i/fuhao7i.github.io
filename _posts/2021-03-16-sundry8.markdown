---
layout:     post
title:      "Daliæ‚è´§é“ºğŸ°8â€”â€”PyTorch ä¿å­˜,åŠ è½½å’ŒæŸ¥çœ‹è®­ç»ƒå¥½çš„æ¨¡å‹"
subtitle:   " \"save, load, weights, è½½å…¥é¢„è®­ç»ƒæƒé‡\""
date:       2021-03-16 00:35:00
author:     "fuhao7i"
header-img: "img/in-post/sundry.jpg"
catalog: true
tags:
    - Daliæ‚è´§é“ºğŸ°
---

# 1. ä¿å­˜æ¨¡å‹

```python
torch.save(model.state_dict(),"./Double.pth")
```

# 2. åŠ è½½è®­ç»ƒå¥½çš„æ¨¡å‹

```python
# åˆ›å»ºæ¨¡å‹
model=Net()
# åŠ è½½é¢„è®­ç»ƒæ¨¡å‹çš„å‚æ•°
model.load_state_dict(torch.load("./Double.pth"))
```

# 3. æŸ¥çœ‹è®­ç»ƒå¥½çš„æ¨¡å‹

```python
import torch 
content = torch.load('/root/.cache/torch/hub/checkpoints/resnet50-19c8e357.pth')

for key in content:
    print(key, content[key].size(),sep='      ')
```

`æˆ–`

```python
import torch  # å‘½ä»¤è¡Œæ˜¯é€è¡Œç«‹å³æ‰§è¡Œçš„
content = torch.load('/root/.cache/torch/hub/checkpoints/resnet50-19c8e357.pth')

for key, value in content:
    print(key, value.size(),sep='      ')
```

`result:`

```Bash
conv1.weight      torch.Size([64, 3, 7, 7])
bn1.running_mean      torch.Size([64])
bn1.running_var      torch.Size([64])
bn1.weight      torch.Size([64])
bn1.bias      torch.Size([64])
layer1.0.conv1.weight      torch.Size([64, 64, 1, 1])
layer1.0.bn1.running_mean      torch.Size([64])
layer1.0.bn1.running_var      torch.Size([64])
layer1.0.bn1.weight      torch.Size([64])
layer1.0.bn1.bias      torch.Size([64])
layer1.0.conv2.weight      torch.Size([64, 64, 3, 3])
layer1.0.bn2.running_mean      torch.Size([64])
layer1.0.bn2.running_var      torch.Size([64])
layer1.0.bn2.weight      torch.Size([64])
   ...
```

# 4. å°†å¯¹åº”å±‚çš„é¢„è®­ç»ƒæƒé‡å¯¼å…¥

```python
pretrained_dict = torch.load('/content/drive/MyDrive/search/mmdetection/data/resneXt_imagenet_338x600.pth')
model_dict = self.model.state_dict()
pretrained_dict = {k: v for k, v in pretrained_dict.items() if k in model_dict}
model_dict.update(pretrained_dict)
self.model.load_state_dict(model_dict)
```

# #. å¼•ç”¨

1. [PyTorchä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹(ä¿å­˜ï¼ŒåŠ è½½ï¼ŒåŠ è½½éƒ¨åˆ†ï¼Œå†»ç»“æŸäº›å‚æ•°ï¼Œä¿®æ”¹ç½‘ç»œæŸäº›å±‚ç­‰...)](https://zhuanlan.zhihu.com/p/137562717)
