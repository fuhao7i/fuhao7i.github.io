---
layout:     post
title:      "Modular torchðŸ’Œ1â€”â€”load checkpoint"
subtitle:   " \"load weights into state dict\""
date:       2021-04-17 09:06:00
author:     "fuhao7i"
header-img: "img/in-post/torch.jpg"
catalog: true
tags:
    - Modular torchðŸ’Œ
---

> Modular loading checkpoint

```python
# ------------------------------------------------- #
#   put your checkpoint path into "checkpoint_path". 
# ------------------------------------------------- #
checkpoint_path = " checkpoint path "
print('Loading weights into state dict...')
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
model_dict = model.state_dict()
pretrained_dict = torch.load(checkpoint_path, map_location=device)
pretrained_dict = {k: v for k, v in pretrained_dict.items() if np.shape(model_dict[k]) ==  np.shape(v)}
model_dict.update(pretrained_dict)
model.load_state_dict(model_dict)
print('Finished!')
```