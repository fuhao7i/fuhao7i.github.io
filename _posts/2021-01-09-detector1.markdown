---
layout:     post
title:      "DetectorğŸ¯1â€”â€”mmdetectionç¯å¢ƒé…ç½®"
subtitle:   " \"mmdetectionå·¥å…·ç®±å­¦ä¹ è®°å½•\""
date:       2021-01-09 20:19:00
author:     "fuhao7i"
header-img: "img/in-post/mubiaojiance.jpg"
catalog: true
tags:
    - DetectorğŸ¯
---

> å…¶å®å°±æ˜¯éœ€è¦æˆ‘ä»¬æ³¨æ„CUDAï¼ŒcuDNNï¼Œtorchï¼Œtorchvisionä¹‹é—´çš„ç‰ˆæœ¬å¯¹åº”ã€‚è¿™ä¸ªç¯å¢ƒæŒºéº»çƒ¦çš„ï¼Œæœ‰ä¸€ç‚¹æ²¡é…ç½®å¥½åœ¨è¿è¡Œç¨‹åºçš„æ—¶å€™å¯èƒ½å°±ä¼šæœ‰å¾ˆå¤šé”™è¯¯ã€‚æ›´åŠ è¯¦ç»†çš„é…ç½®torch GPUç‰ˆæœ¬å¯ä»¥å‚è€ƒæˆ‘çš„å¦ä¸€ç¯‡åšå®¢[Daliå·¥å…·ç®±ğŸ”§1â€”â€”torch GPUç‰ˆæœ¬ç¯å¢ƒé…ç½®](https://fuhao7i.com/2021/01/10/dalitools1/)ã€‚

# 1.Google colabç¯å¢ƒé…ç½®

Google colabæä¾›çš„å…è´¹GPUï¼Œæ˜¯æˆ‘ç›®å‰å­¦ä¹ çš„ä¸»è¦å·¥å…·ã€‚å¾ˆé€‚åˆè¿˜æ²¡æœ‰è¿›ç»„çš„åŒå­¦ä»¬è¿›è¡Œæ·±åº¦å­¦ä¹ ç»ƒæ‰‹å’Œå­¦ä¹ ã€‚

## 1.1 è¿æ¥Google Drive

```python
# è¿æ¥Googleäº‘ç›˜
import os
from google.colab import drive
drive.mount('/content/drive')
# pathæ˜¯ipynbçš„å·¥ä½œè·¯å¾„
path = "/content/drive/My Drive/æ°´ä¸‹ç›®æ ‡æ£€æµ‹/HitDetection"

os.chdir(path)
os.listdir(path)
```

## 1.2 å®‰è£…Anaconda3

```Bash
!wget -q https://repo.anaconda.com/archive/Anaconda3-2019.10-Linux-x86_64.sh
!chmod +x Anaconda3-2019.10-Linux-x86_64.sh
!bash ./Anaconda3-2019.10-Linux-x86_64.sh -b -f -p /content/drive/MyDrive/anaconda3
# set PATH environment variable
# æ·»åŠ åˆ°ç³»ç»Ÿå˜é‡ä¸­
import os
os.environ['PATH'] = "/content/drive/MyDrive/anaconda3/bin:" + os.environ['PATH']
```

æŸ¥çœ‹å½“å‰æ‰€æœ‰çš„ç¯å¢ƒå˜é‡ï¼š

```python
import os
os.environ.key() #æŸ¥çœ‹å½“å‰æ‰€æœ‰çš„ç¯å¢ƒå˜é‡
```

colabä¸­ç”¨anacondaç¯å¢ƒæ¥è¿è¡Œpythonæ–‡ä»¶ï¼š

```Bash
!source activate ç¯å¢ƒå && python æ–‡ä»¶.py
```

## 1.3 å®‰è£…gcc(g++5)

ç”±äºç³»ç»Ÿè‡ªå¸¦äº†ä¸€ä¸ªç‰ˆæœ¬çš„gccï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å…ˆåˆ é™¤ç³»ç»Ÿçš„gccæ–‡ä»¶ï¼Œå†å®‰è£…æˆ‘ä»¬éœ€è¦çš„ç‰ˆæœ¬ã€‚

```Bash
!apt-get install gcc-5 g++-5
!cd /usr/bin && sudo rm gcc-7 g++-7 gcc g++ && sudo ln gcc-5 gcc && sudo ln g++-5 g++
```

## 1.4 å®‰è£…pytorchå’Œcudatoolkit

[æ³¨æ„torchå’Œcudaçš„ç‰ˆæœ¬ï¼Œè¿™é‡Œæ˜¯torchçš„ä¸€ä¸ªå®˜æ–¹æ–‡æ¡£ï¼Œå¯ä»¥æŸ¥çœ‹ç‰ˆæœ¬å¯¹åº”å…³ç³»ã€‚](https://pytorch.org/get-started/previous-versions/)

```Bash
!conda install cython
!conda install pytorch=1.3.1 torchvision cudatoolkit=10.0 nccl -c pytorch
```

# 2. colabé‡æ–°å®‰è£…CUDA9.0, torch1.1.0, torchvision0.3.0

## 1. å®‰è£…CUDA9.0

è¿™ä¸ªä¼šè‡ªåŠ¨é…ç½®å¥½ç³»ç»Ÿç¯å¢ƒã€‚

```Bash
!wget https://developer.nvidia.com/compute/cuda/9.0/Prod/local_installers/cuda-repo-ubuntu1604-9-0-local_9.0.176-1_amd64-deb
!dpkg -i cuda-repo-ubuntu1604-9-0-local_9.0.176-1_amd64-deb
!apt-key add /var/cuda-repo-9-0-local/7fa2af80.pub
!apt-get update
!apt-get install cuda=9.0.176-1
```

## 2. å¸è½½åŸæœ‰çš„torchå’Œtorchvision

```Bash
!pip uninstall torch
!pip uninstall torchvision
```

## 3. å®‰è£…torchvisionå’Œtorch

```Bash
!pip install torchvision==0.3.0
!pip install -q torch==1.1.0
```

## 4.ä¹‹åsh env.shå®‰è£…ç¨‹åºä¾èµ–

```Bash
!sh env.sh
```

# 3. [æ›´å¤šç¯å¢ƒé…ç½®é—®é¢˜è¯·çœ‹Dali toolsğŸ”§](https://fuhao7i.com/2021/01/09/detector1/)