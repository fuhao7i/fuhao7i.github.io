---
layout:     post
title:      "Daliå·¥å…·ç®±ðŸ•¶5â€”â€”the use of numpy"
subtitle:   " \"np.where, np.argmax, np.argmin, np.eye, np.seed, np.vstack, np.hstack, torch.sum, squeeze \""
date:       2021-04-17 12:13:00
author:     "fuhao7i"
header-img: "img/in-post/tools.jpg"
catalog: true
tags:
    - Daliå·¥å…·ç®±ðŸ•¶
---

# 1. Boolean indexes

```python
import numpy as np

a = np.arange(12).reshape(3,4)

print('-' * 20)
print(a)
print('-' * 20)
# æ•°ç»„aä¸­æ‰€æœ‰å¤§äºŽ5çš„ä½ç½®ä¸ºTrue, å…¶ä½™ä¸ºFalse
print(a>5)
print('-' * 20)
# å°†æ•°ç»„aä¸­æ‰€æœ‰å¤§äºŽ5çš„ä½ç½®èµ‹å€¼ä¸º999
a[a>5]=999
print(a)
```

```Bash
--------------------
[[ 0  1  2  3]
 [ 4  5  6  7]
 [ 8  9 10 11]]
-------a > 5-------
[[False False False False]
 [False False  True  True]
 [ True  True  True  True]]
-------a[a>5]=999-------
[[  0   1   2   3]
 [  4   5 999 999]
 [999 999 999 999]]
```

# 2. ä¸‰å…ƒè¿ç®—ç¬¦
`np.where`
```python
import numpy as np

a = np.arange(12).reshape(3,4)

print('-' * 20)
print(a)
print('-' * 20)
# aä¸­å¤§äºŽ5çš„ä½ç½®ä¸º999, å…¶ä½™ä¸º111
np.where(a>5, 999, 111)
```

```Bash
--------------------
[[ 0  1  2  3]
 [ 4  5  6  7]
 [ 8  9 10 11]]
-------np.where-------
array([[111, 111, 111, 111],
       [111, 111, 999, 999],
       [999, 999, 999, 999]])
```

# 3. clip

```python
import numpy as np

a = np.arange(12).reshape(3,4)

print('-' * 20)
print(a)
print('-' * 20)
# aå°äºŽ4çš„å…¨éƒ½èµ‹å€¼ä¸º4ï¼Œå¤§äºŽ8çš„å…¨éƒ½èµ‹å€¼ä¸º8
a.clip(4, 8)
```

```Bash
--------------------
[[ 0  1  2  3]
 [ 4  5  6  7]
 [ 8  9 10 11]]
-------clip-------
array([[4, 4, 4, 4],
       [4, 5, 6, 7],
       [8, 8, 8, 8]])
```

# 4. stack

`np.vstack() åˆ—æ‹¼æŽ¥` and `np.hstack() è¡Œæ‹¼æŽ¥`

```python
import numpy as np

t1 = np.arange(12).reshape(3,4)
t2 = np.arange(12).reshape(3,4)

print('-' * 20)
print(t1)
print('-' * 20)
print(t2)
print('-' * 20)
np.vstack((t1,t2))
np.hstack((t1,t2))
```

```Bash
--------------------
[[ 0  1  2  3]
 [ 4  5  6  7]
 [ 8  9 10 11]]
--------------------
[[ 0  1  2  3]
 [ 4  5  6  7]
 [ 8  9 10 11]]
-------åˆ—æ‹¼æŽ¥-------
array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11],
       [ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11]])
-------è¡Œæ‹¼æŽ¥-------
array([[ 0,  1,  2,  3,  0,  1,  2,  3],
       [ 4,  5,  6,  7,  4,  5,  6,  7],
       [ 8,  9, 10, 11,  8,  9, 10, 11]])
```

# 5. è¡Œåˆ—äº¤æ¢

```python
import numpy as np

t1 = np.arange(12).reshape(3,4)

print('-' * 20)
print(t1)
print('-' * 20)
t1[[1,2],:] = t1[[2,1],:] # è¡Œäº¤æ¢
print(t1)
print('-' * 20)
t1[:,[0,2]] = t1[:,[2,0]] # äº¤æ¢
print(t1)
```

```Bash
-------åŽŸå§‹t1-------
[[ 0  1  2  3]
 [ 4  5  6  7]
 [ 8  9 10 11]]
-------è¡Œäº¤æ¢-------
[[ 0  1  2  3]
 [ 8  9 10 11]
 [ 4  5  6  7]]
-------åˆ—äº¤æ¢-------
[[ 2  1  0  3]
 [10  9  8 11]
 [ 6  5  4  7]]
```

# 6. squeeze and unsqueeze

**squeezeä½œç”¨: ä»Žæ•°ç»„çš„å½¢çŠ¶ä¸­åˆ é™¤å•ç»´åº¦æ¡ç›®ï¼Œå³æŠŠshapeä¸­ä¸º1çš„ç»´åº¦åŽ»æŽ‰**

```python
import numpy as np

a  = np.arange(10).reshape(1,10)
print(a)
print(a.shape)
```
```Bash
array([[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])

(1, 10)
```
```python
b = np.squeeze(a)
print(b)
print(b.shape)
```
```Bash
array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])

(10,)
```

**å¯¹ç»´åº¦ä¸ä¸º1çš„ç»´åº¦æ²¡æœ‰ç”¨**

**unsqueezeä½œç”¨: å¢žåŠ ä¸€ä¸ªç»´åº¦**

ä¾‹å¦‚: a çš„ç»´åº¦ä¸º(3, 4), a.unsqueeze(1) å°±æ˜¯åœ¨ç¬¬äºŒç»´å¢žåŠ ä¸€ä¸ªç»´åº¦ä½¿å…¶å˜ä¸º(3, 1, 4)

# 7. numpyçš„copyå’Œview

`a = b å®Œå…¨ä¸å¤åˆ¶, aå’Œbç›¸äº’å½±å“`

```python
import numpy as np

a = np.arange(12).reshape(3,4)

print('-' * 20)
print(a)
print('-' * 20)
b = a
b[b>5] = 999
print(a)
print('-' * 20)
a[a<2] = 111
print(b)
```

```Bash
-------åˆå§‹çš„a-------
[[ 0  1  2  3]
 [ 4  5  6  7]
 [ 8  9 10 11]]
-------æ”¹å˜bçœ‹açš„å€¼-------
[[  0   1   2   3]
 [  4   5 999 999]
 [999 999 999 999]]
-------æ”¹å˜açœ‹bçš„å€¼-------
[[111 111   2   3]
 [  4   5 999 999]
 [999 999 999 999]]
```

`a=b[:], è§†å›¾çš„æ“ä½œï¼Œä¸€ç§åˆ‡ç‰‡ï¼Œä¼šåˆ›å»ºæ–°çš„å¯¹è±¡a, ä½†æ˜¯açš„æ•°æ®å®Œå…¨ç”±bä¿ç®¡, ä»–ä»¬ä¸¤ä¸ªçš„æ•°æ®å˜åŒ–æ˜¯ä¸€è‡´çš„`ï¼Œå’Œä¸Šä¸ªæ“ä½œa=bä¸€æ ·ï¼Œéƒ½æ˜¯ç›¸äº’å½±å“

`a = b.copy()`å¤åˆ¶ï¼Œaå’Œbäº’ä¸å½±å“

# 8. torch.sum

```python
import torch

a = torch.tensor([[[[1,2,3],[4,5,6]],[[7,8,9],[10,11,12]]], [[[1,2,3],[4,5,6]],[[7,8,9],[10,11,12]]]])
b = torch.tensor([[[[1,0,0],[0,1,0]],[[0,0,1],[0,1,0]]], [[[1,0,0],[0,1,0]],[[0,0,1],[0,1,0]]]])
print(a)
print('-'*20)
print(a.shape)
print('-'*20)
print(torch.sum(a, 0))
print('-'*20)
print(torch.sum(a, 1))
print('-'*20)
print(torch.sum(a, [0,1]))
print('='*20)
print(a*b)
print('='*30)
print(torch.sum(a*b, 0))
print(torch.sum(a*b, [0,1]))
```

```Bash
tensor([[[[ 1,  2,  3],
          [ 4,  5,  6]],

         [[ 7,  8,  9],
          [10, 11, 12]]],


        [[[ 1,  2,  3],
          [ 4,  5,  6]],

         [[ 7,  8,  9],
          [10, 11, 12]]]])
--------------------
torch.Size([2, 2, 2, 3])
--------------------
tensor([[[ 2,  4,  6],
         [ 8, 10, 12]],

        [[14, 16, 18],
         [20, 22, 24]]])
--------------------
tensor([[[ 8, 10, 12],
         [14, 16, 18]],

        [[ 8, 10, 12],
         [14, 16, 18]]])
--------------------
tensor([[16, 20, 24],
        [28, 32, 36]])
====================
tensor([[[[ 1,  0,  0],
          [ 0,  5,  0]],

         [[ 0,  0,  9],
          [ 0, 11,  0]]],


        [[[ 1,  0,  0],
          [ 0,  5,  0]],

         [[ 0,  0,  9],
          [ 0, 11,  0]]]])
==============================
tensor([[[ 2,  0,  0],
         [ 0, 10,  0]],

        [[ 0,  0, 18],
         [ 0, 22,  0]]])
tensor([[ 2,  0, 18],
        [ 0, 32,  0]])
```

# 9. sundry

- **np.argmax(t, axis=0)** èŽ·å–æ•°ç»„tç¬¬0ç»´æœ€å¤§å€¼çš„ä½ç½®
- **np.argmin(t, axis=0)** èŽ·å–æ•°ç»„tç¬¬0ç»´æœ€å°å€¼çš„ä½ç½®
- **np.zeros((3,4))** åˆ›å»ºå…¨0æ•°ç»„
- **np.ones((3,4))** åˆ›å»ºå…¨1æ•°ç»„
- **np.eye(3)** åˆ›å»ºä¸€ä¸ªå¯¹è§’çº¿å…¨ä¸º1ï¼Œå…¶ä½™å…¨ä¸º0çš„æ­£æ–¹å½¢çŸ©é˜µ
- **np.seed(s)** éšæœºæ•°ç§å­ï¼Œsæ˜¯ç»™å®šçš„ç§å­å€¼ã€‚å› ä¸ºè®¡ç®—æœºç”Ÿæˆçš„æ˜¯ä¼ªéšæœºæ•°ï¼Œæ‰€ä»¥é€šè¿‡è®¾å®šç›¸åŒçš„éšæœºæ•°ç§å­ï¼Œå¯ä»¥æ¯æ¬¡ç”Ÿæˆç›¸åŒçš„éšæœºæ•°