I"ºX<h1 id="0-ç”Ÿæˆtraintxt">0. ç”Ÿæˆtrain.txt</h1>

<blockquote>
  <p>åƒä¸€ä¸ªæ–‡ä»¶å¤¹ä»£è¡¨ä¸€ç±»çš„æ•°æ®é›†ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒçš„æ–‡ä»¶åè¯»å–å‡ºæ¥ï¼ŒæŒ‰ç…§{ æ–‡ä»¶å;ç±»åˆ« }çš„æ ¼å¼å°†å®ƒä»¬ä¿å­˜åˆ°train.txtæ–‡ä»¶ä¸­ä»¥ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼›åŒç†ï¼Œå¯¹äºè¯­ä¹‰åˆ†å‰²æˆ–ç›®æ ‡æ£€æµ‹çš„æ•°æ®é›†ï¼Œæˆ‘ä»¬æŒ‰ç…§ { img;label } çš„æ ¼å¼ä¿å­˜åˆ°train.txtæ–‡ä»¶ä¸­ã€‚</p>
</blockquote>

<p><code class="language-plaintext highlighter-rouge">æ–‡ä»¶ç›®å½•:</code></p>

<p><img src="https://img-blog.csdnimg.cn/20210313143137962.png" /></p>

<p>è¿™é‡Œæˆ‘ä»¬å…ˆä»ImageNetæ•°æ®é›†æ¯ä¸ªç±»åˆ«ä¸­éšæœºæŠ½å–30%æ¥ä½œä¸ºè®­ç»ƒé›†ï¼Œå‰©ä¸‹çš„70%ä»¥åå†ç”¨ã€‚</p>

<p><code class="language-plaintext highlighter-rouge">to_train_txt.py</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">os</span><span class="p">,</span> <span class="n">random</span>

<span class="n">_label</span> <span class="o">=</span> <span class="p">{</span><span class="s">'n01924916'</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">'n01943899'</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s">'n01950731'</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s">'n01968897'</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s">'n02317335'</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s">'n02319095'</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s">'n02321529'</span><span class="p">:</span><span class="mi">6</span><span class="p">}</span>

<span class="n">train_path</span> <span class="o">=</span> <span class="s">'./train/'</span>

<span class="n">pathDir</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">train_path</span><span class="p">)</span>

<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'./train_3.txt'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
<span class="n">ff</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'./train_7.txt'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">pathDir</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">ii</span> <span class="o">!=</span> <span class="s">'.DS_Store'</span><span class="p">:</span>
        <span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">_label</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
        
        <span class="n">rate</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">train_path</span> <span class="o">+</span> <span class="n">ii</span><span class="p">)</span>
        <span class="n">filenumber</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">picknumber</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">filenumber</span> <span class="o">*</span> <span class="n">rate</span><span class="p">)</span>

        <span class="n">sample</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">sample</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">picknumber</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">filename</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">sample</span><span class="p">:</span>
                <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">ii</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">ob</span> <span class="o">+</span> <span class="s">';'</span> <span class="o">+</span> <span class="n">label</span> <span class="o">+</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ff</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">ii</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">ob</span> <span class="o">+</span> <span class="s">';'</span> <span class="o">+</span> <span class="n">label</span> <span class="o">+</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>


<span class="n">f</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">ff</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">éƒ¨åˆ†train_3.txtå±•ç¤º:</code></p>

<pre><code class="language-Bash">...

n02319095/n02319095_350.JPEG;5
n02319095/n02319095_3527.JPEG;5
n02319095/n02319095_10100.JPEG;5
n02319095/n02319095_583.JPEG;5
n02319095/n02319095_1263.JPEG;5
n02319095/n02319095_8412.JPEG;5
n02319095/n02319095_7026.JPEG;5
n02319095/n02319095_2398.JPEG;5
n02319095/n02319095_7030.JPEG;5
n02319095/n02319095_487.JPEG;5
n02319095/n02319095_6733.JPEG;5
n02319095/n02319095_1019.JPEG;5
n02319095/n02319095_8238.JPEG;5
n02319095/n02319095_4077.JPEG;5
n02319095/n02319095_4630.JPEG;5
n02319095/n02319095_444.JPEG;5
n02319095/n02319095_1936.JPEG;5
n02319095/n02319095_2025.JPEG;5
n02319095/n02319095_956.JPEG;5
n02319095/n02319095_3272.JPEG;5

...
</code></pre>

<h2 id="randomsampleå‡½æ•°ç”¨æ³•">random.sample()å‡½æ•°ç”¨æ³•</h2>

<p>ç”¨äºéšæœºæˆªå–æŒ‡å®šé•¿åº¦çš„åˆ—è¡¨ï¼Œä¸ä¼šæ”¹å˜åŸåˆ—è¡¨ï¼›</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">rs</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

<span class="c1"># [2, 4] 
# [0, 1, 2, 3, 4]        
</span></pre></td></tr></tbody></table></code></pre></div></div>
<p><strong>PyTorchè¾“å…¥æ•°æ®Piplineï¼š</strong></p>

<ol>
  <li>åˆ›å»ºä¸€ä¸ª<code class="language-plaintext highlighter-rouge">Dataset</code>å¯¹è±¡;</li>
  <li>åˆ›å»ºä¸€ä¸ª<code class="language-plaintext highlighter-rouge">DataLoader</code>å¯¹è±¡;</li>
  <li>å¾ªç¯è¿™ä¸ª<code class="language-plaintext highlighter-rouge">DataLoader</code>å¯¹è±¡ï¼Œå°†<code class="language-plaintext highlighter-rouge">img</code>å’Œ<code class="language-plaintext highlighter-rouge">label</code>åŠ è½½åˆ°æ¨¡å‹ä¸­è¿›è¡Œè®­ç»ƒ;</li>
</ol>

<h1 id="1-åˆ›å»ºdatasetå¯¹è±¡">1. åˆ›å»ºDatasetå¯¹è±¡</h1>

<p>åˆ›å»ºçš„æ—¶å€™éœ€ç»§æ‰¿<code class="language-plaintext highlighter-rouge">from torch.utils.data.dataset import Dataset</code>ç±»ã€‚</p>

<p><strong>Datasetä¸­ä¸»è¦æœ‰3ä¸ªæ–¹æ³•:</strong></p>

<ol>
  <li><strong>init</strong>: åˆå§‹åŒ–ä¿¡æ¯ï¼ŒåŒ…æ‹¬è®­ç»ƒæ•°æ®å’Œæ ‡ç­¾çš„è·¯å¾„, transformä¿¡æ¯ç­‰;</li>
  <li><strong>getitem</strong>: åœ¨è¿™ä¸ªæ–¹æ³•é‡Œæ ¹æ®ä¼ å…¥çš„ä¸‹æ ‡è¿”å›labelå’Œtransformä¹‹åçš„å›¾ç‰‡tensor;</li>
  <li><strong>len</strong>: è¿”å›Datasetçš„é•¿åº¦;</li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torchvision.transforms</span> <span class="k">as</span> <span class="n">transforms</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span>


<span class="k">class</span> <span class="nc">MyDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>  <span class="c1"># åˆ›ç±»ï¼šMyDataset,ç»§æ‰¿torch.utils.data.Dataset
</span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datatxt</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyDataset</span><span class="p">,</span> <span class="bp">self</span><span class="p">).</span><span class="n">__init__</span><span class="p">()</span>
        <span class="n">fh</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">datatxt</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>  <span class="c1"># æ‰“å¼€txtï¼Œè¯»å–å†…å®¹
</span>        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fh</span><span class="p">:</span>  <span class="c1"># æŒ‰è¡Œå¾ªç¯txtæ–‡æœ¬ä¸­çš„å†…å®¹
</span>            <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">';'</span><span class="p">)</span>  <span class="c1"># é€šè¿‡æŒ‡å®šåˆ†éš”ç¬¦å¯¹å­—ç¬¦ä¸²è¿›è¡Œåˆ‡ç‰‡
</span>            <span class="n">data</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>  <span class="c1"># æŠŠtxté‡Œçš„å†…å®¹è¯»å…¥dataåˆ—è¡¨ä¿å­˜ï¼Œwords[0]æ˜¯å›¾ç‰‡ä¿¡æ¯ï¼Œwords[1]æ˜¯label
</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">transform</span> <span class="o">=</span> <span class="n">transform</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>  <span class="c1"># æŒ‰ç…§ç´¢å¼•è¯»å–æ¯ä¸ªå…ƒç´ çš„å…·ä½“å†…å®¹
</span>        <span class="n">fn</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>  <span class="c1"># fnæ˜¯å›¾ç‰‡path
</span>        <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">).</span><span class="n">convert</span><span class="p">(</span><span class="s">'RGB'</span><span class="p">)</span>  <span class="c1"># from PIL import Image
</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">transform</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>  <span class="c1"># æ˜¯å¦è¿›è¡Œtransform
</span>            <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">img</span><span class="p">,</span> <span class="n">label</span>  <span class="c1"># returnå›å“ªäº›å†…å®¹ï¼Œåœ¨è®­ç»ƒæ—¶å¾ªç¯è¯»å–æ¯ä¸ªbatchï¼Œå°±èƒ½è·å¾—å“ªäº›å†…å®¹
</span>
    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># å®ƒè¿”å›çš„æ˜¯æ•°æ®é›†çš„é•¿åº¦ï¼Œå¿…é¡»æœ‰
</span>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">imgs</span><span class="p">)</span>


<span class="s">'''æ ‡å‡†åŒ–ã€å›¾ç‰‡å˜æ¢'''</span>
<span class="n">train_transforms</span> <span class="o">=</span> <span class="n">transforms</span><span class="p">.</span><span class="n">Compose</span><span class="p">([</span>
    <span class="n">transforms</span><span class="p">.</span><span class="n">RandomCrop</span><span class="p">(</span><span class="mi">224</span><span class="p">),</span>
    <span class="n">transforms</span><span class="p">.</span><span class="n">RandomHorizontalFlip</span><span class="p">(),</span>
    <span class="n">transforms</span><span class="p">.</span><span class="n">ToTensor</span><span class="p">()</span>
    <span class="p">])</span>

<span class="n">train_data</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="n">datatxt</span><span class="o">=</span><span class="s">'train.txt'</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">train_transforms</span><span class="p">)</span>

<span class="n">train_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="s">""" è®­ç»ƒæ—¶:"""</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_epoches</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataloader</span><span class="p">):</span>
        <span class="p">...</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="transformå„å‚æ•°çš„ä½œç”¨">transformå„å‚æ•°çš„ä½œç”¨ï¼š</h2>

<pre><code class="language-Bash">1. è£å‰ªâ€”â€”Crop

ä¸­å¿ƒè£å‰ªï¼štransforms.CenterCrop
éšæœºè£å‰ªï¼štransforms.RandomCrop
éšæœºé•¿å®½æ¯”è£å‰ªï¼štransforms.RandomResizedCrop
ä¸Šä¸‹å·¦å³ä¸­å¿ƒè£å‰ªï¼štransforms.FiveCrop
ä¸Šä¸‹å·¦å³ä¸­å¿ƒè£å‰ªåç¿»è½¬ï¼Œtransforms.TenCrop

2. ç¿»è½¬å’Œæ—‹è½¬â€”â€”Flip and Rotation

ä¾æ¦‚ç‡pæ°´å¹³ç¿»è½¬ï¼štransforms.RandomHorizontalFlip(p=0.5)
ä¾æ¦‚ç‡på‚ç›´ç¿»è½¬ï¼štransforms.RandomVerticalFlip(p=0.5)
éšæœºæ—‹è½¬ï¼štransforms.RandomRotation

3. å›¾åƒå˜æ¢

resizeï¼štransforms.Resize
æ ‡å‡†åŒ–ï¼štransforms.Normalize
è½¬ä¸ºtensorï¼Œå¹¶å½’ä¸€åŒ–è‡³[0-1]ï¼štransforms.ToTensor
å¡«å……ï¼štransforms.Pad
ä¿®æ”¹äº®åº¦ã€å¯¹æ¯”åº¦å’Œé¥±å’Œåº¦ï¼štransforms.ColorJitter
è½¬ç°åº¦å›¾ï¼štransforms.Grayscale
çº¿æ€§å˜æ¢ï¼štransforms.LinearTransformation()
ä»¿å°„å˜æ¢ï¼štransforms.RandomAffine
ä¾æ¦‚ç‡pè½¬ä¸ºç°åº¦å›¾ï¼štransforms.RandomGrayscale
å°†æ•°æ®è½¬æ¢ä¸ºPILImageï¼štransforms.ToPILImage
transforms.Lambdaï¼šApply a user-defined lambda as a transform.

4. å¯¹transformsæ“ä½œï¼Œä½¿æ•°æ®å¢å¼ºæ›´çµæ´»

transforms.RandomChoice(transforms)ï¼Œ ä»ç»™å®šçš„ä¸€ç³»åˆ—transformsä¸­é€‰ä¸€ä¸ªè¿›è¡Œæ“ä½œ
transforms.RandomApply(transforms, p=0.5)ï¼Œç»™ä¸€ä¸ªtransformåŠ ä¸Šæ¦‚ç‡ï¼Œä¾æ¦‚ç‡è¿›è¡Œæ“ä½œ
transforms.RandomOrderï¼Œå°†transformsä¸­çš„æ“ä½œéšæœºæ‰“ä¹±

</code></pre>

<h1 id="2-åˆ›å»ºdataloaderå¯¹è±¡">2. åˆ›å»ºDataLoaderå¯¹è±¡</h1>

<p><code class="language-plaintext highlighter-rouge">DataLoader: </code>å°†è‡ªå®šä¹‰çš„Datasetæ ¹æ®batch sizeå¤§å°ã€æ˜¯å¦shuffleç­‰å°è£…æˆä¸€ä¸ªBatch Sizeå¤§å°çš„Tensorï¼Œç”¨äºåé¢çš„è®­ç»ƒã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">DataLoader</span>

<span class="n">train_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h1 id="3-å¾ªç¯dataloaderè¿›è¡Œè®­ç»ƒ">3. å¾ªç¯DataLoaderè¿›è¡Œè®­ç»ƒ</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_epoches</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataloader</span><span class="p">):</span>
        <span class="p">...</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h1 id="-æ³¨æ„">** æ³¨æ„</h1>

<p>æŸå¤±å‡½æ•°<code class="language-plaintext highlighter-rouge">torch.nn.CrossEntropyLoss()</code>ä¸­å·²ç»åŒ…å«äº†<code class="language-plaintext highlighter-rouge">Softmax</code>å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œç›´æ¥çº¿æ€§è¾“å‡ºå³å¯ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="n">net</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="n">Sequential</span><span class="p">(</span>
            <span class="n">nn</span><span class="p">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span>
            <span class="n">nn</span><span class="p">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="p">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
            <span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h1 id="å¼•ç”¨">#.å¼•ç”¨</h1>

<ol>
  <li><a href="https://blog.csdn.net/u011995719/article/details/85107009">PyTorch å­¦ä¹ ç¬”è®°ï¼ˆä¸‰ï¼‰ï¼štransformsçš„äºŒåäºŒä¸ªæ–¹æ³•</a></li>
  <li><a href="https://zh.d2l.ai/index.html">åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ </a></li>
  <li><a href="https://blog.csdn.net/hnu_zzt/article/details/85092092?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-10.control&amp;dist_request_id=1328642.24603.16156240016207327&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-10.control">pytorchä¸€æ­¥ä¸€æ­¥åœ¨VGG16ä¸Šè®­ç»ƒè‡ªå·±çš„æ•°æ®é›†</a></li>
  <li><a href="https://www.cnblogs.com/panchuangai/p/12567996.html">PyTorch ImageNet åŸºäºé¢„è®­ç»ƒå…­å¤§å¸¸ç”¨å›¾ç‰‡åˆ†ç±»æ¨¡å‹çš„å®æˆ˜</a></li>
  <li><a href="https://blog.csdn.net/m0_37163827/article/details/110521518">pytorchæ­å»ºåˆ†ç±»ç½‘ç»œå¹¶è¿›è¡Œè®­ç»ƒå’Œæµ‹è¯•</a></li>
  <li><a href="https://www.cnblogs.com/zhangxiann/p/13570884.html">äºŒåäºŒç§ transforms å›¾ç‰‡æ•°æ®é¢„å¤„ç†æ–¹æ³•</a></li>
  <li><a href="https://www.zhihu.com/question/360010590">æ·±åº¦å­¦ä¹ ç¥ç»ç½‘ç»œå¯¹äºå°ºå¯¸ä¸åŒçš„å›¾ç‰‡å¦‚ä½•å¤„ç†ï¼Ÿresizeï¼Ÿcropï¼Ÿ</a></li>
</ol>
:ET